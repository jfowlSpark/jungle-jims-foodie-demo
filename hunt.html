<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Your Ingredient Hunt</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            fancy: ['Quicksand', 'sans-serif']
          },
          colors: {
            jungleGreen: '#1B8A5A',
            jungleGold: '#F3C969',
            jungleRed: '#E94F37',
            jungleCream: '#FAF4E6',
          },
          animation: {
            fadeIn: "fadeIn 0.45s ease-out",
            slideIn: "slideIn 0.4s ease-out",
            popIn: "popIn 0.45s ease-out",
            shimmer: "shimmer 0.5s ease-in-out",
            successPop: "successPop 0.5s ease-out"
          }
        }
      }
    }
  </script>

  <link rel="stylesheet" href="styles.css" />

  <style>
    body { font-family: 'Quicksand', sans-serif; }
  </style>
</head>

<body class="min-h-screen relative bg-gradient-to-br from-jungleGreen via-jungleCream to-jungleGold overflow-hidden">

  <!-- Vines -->
  <img src="img/vines_top_left.png" class="absolute top-0 left-0 w-32 opacity-60 pointer-events-none">
  <img src="img/vines_top_right.png" class="absolute top-0 right-0 w-32 opacity-60 pointer-events-none">

  <!-- Replay Audio -->
  <button id="replayBtn"
    class="hidden fixed bottom-6 right-6 w-14 h-14 bg-white/90 border-2 border-jungleGreen rounded-full shadow-xl 
           flex items-center justify-center text-jungleGreen text-2xl active:scale-90 transition z-50">
    üîä
  </button>

  <!-- Ingredient Progress Display -->
  <div id="stepIndicator" class="fixed top-4 left-1/2 -translate-x-1/2 text-white font-bold text-lg drop-shadow z-10">
    Ingredient <span id="stepNum">1</span> of 4
  </div>

  <!-- MAIN CONTENT WRAPPER -->
  <div id="huntWrapper" class="w-full max-w-md mx-auto text-center mt-16 p-4"></div>

  <!-- AUDIO (you provide these files) -->
  <audio id="audio1" src="audio/chef4_pasta.mp3"></audio>
  <audio id="audio2" src="audio/chef5_sauce.mp3"></audio>
  <audio id="audio3" src="audio/chef6_cheese.mp3"></audio>
  <audio id="audio4" src="audio/chef7_spinach.mp3"></audio>
  <audio id="bing" src="audio/bing.mp3"></audio>

  <script>
    let step = 1;
    let currentAudio = null;

    const wrapper = document.getElementById("huntWrapper");
    const replayBtn = document.getElementById("replayBtn");
    const stepNum = document.getElementById("stepNum");

    /* ---------------------
       UTIL: PLAY AUDIO
    --------------------- */
    function playAudio(id) {
      currentAudio = document.getElementById(id);
      replayBtn.classList.remove("hidden");
      currentAudio.play().catch(()=>{});
    }

    replayBtn.addEventListener("click", () => {
      if (currentAudio) currentAudio.play().catch(()=>{});
    });

    /* ---------------------
       UTIL: NARRATION BOX
    --------------------- */
    function narrationBox(text) {
      return `
        <div class="relative bg-white/80 rounded-xl p-4 mt-4 shadow-md text-left animate-slideIn">
          <div class="absolute -top-3 left-6 w-0 h-0 
                      border-l-8 border-r-8 border-b-8 border-transparent 
                      border-b-white/80"></div>
          <p class="text-gray-700 text-lg leading-relaxed">${text}</p>
        </div>
      `;
    }

    /* ---------------------
       UTIL: CAMERA FRAME
    --------------------- */
    function cameraFrame(imgSrc, altText) {
      return `
        <div class="mt-5 bg-black/80 rounded-3xl p-3 shadow-inner text-left text-xs text-white/60">
          <div class="flex justify-between px-1">
            <span>SCAN MODE</span>
            <span>Live</span>
          </div>
          <div class="mt-2 bg-black rounded-2xl overflow-hidden aspect-[4/3] flex items-center justify-center relative">
            <div class="absolute inset-3 border-2 border-white/40 rounded-2xl pointer-events-none"></div>
            <img src="${imgSrc}" alt="${altText}"
                 class="w-full h-full object-contain" />
          </div>
          <div class="flex justify-center mt-3">
            <div class="w-10 h-10 rounded-full border-2 border-white/70"></div>
          </div>
        </div>
      `;
    }

    /* ---------------------
       INGREDIENT SCREENS
    --------------------- */

    function renderStep1() {
      stepNum.textContent = "1";
      wrapper.innerHTML = `
        <div class="animate-shimmer bg-white/90 rounded-3xl p-6 shadow-xl">
          <img src="img/chefRossi.png"
            class="w-28 h-28 mx-auto rounded-full shadow-xl ring-4 ring-white mb-4 animate-popIn">

          <h2 class="text-2xl font-bold text-jungleRed mb-2">Ingredient #1</h2>

          ${narrationBox(`
            ‚ÄúYour journey begins in the **International Pasta Aisle**!  
            Seek out a bag of **Garofalo Pasta** ‚Äî dark packaging with elegant lettering.  
            Line it up in your camera window, then tap Scan.‚Äù
          `)}

          ${cameraFrame("img/pasta.png", "Garofalo pasta")}

          <button id="scanBtn"
            class="w-full bg-jungleGreen text-white font-semibold rounded-lg py-3 mt-6 shadow active:scale-95">
            Scan Ingredient
          </button>
        </div>
      `;

      document.getElementById("scanBtn").onclick = () => handleScan(2);
      playAudio("audio1");
    }

    function renderStep2() {
      stepNum.textContent = "2";
      wrapper.innerHTML = `
        <div class="animate-shimmer bg-white/90 rounded-3xl p-6 shadow-xl">
          <img src="img/chefRossi.png"
            class="w-28 h-28 mx-auto rounded-full shadow-xl ring-4 ring-white mb-4 animate-popIn">

          <h2 class="text-2xl font-bold text-jungleRed mb-2">Ingredient #2</h2>

          ${narrationBox(`
            ‚ÄúBellissimo! Now head to the **pasta sauce aisle**.  
            You‚Äôre looking for a rich **tomato & basil pasta sauce** ‚Äî  
            deep red color, classic Italian label. Frame it in your camera view, then tap Scan.‚Äù
          `)}

          ${cameraFrame("img/pastaSauce.png", "Tomato basil pasta sauce")}

          <button id="scanBtn"
            class="w-full bg-jungleGreen text-white font-semibold rounded-lg py-3 mt-6 shadow active:scale-95">
            Scan Ingredient
          </button>
        </div>
      `;

      document.getElementById("scanBtn").onclick = () => handleScan(3);
      playAudio("audio2");
    }

    function renderStep3() {
      stepNum.textContent = "3";
      wrapper.innerHTML = `
        <div class="animate-shimmer bg-white/90 rounded-3xl p-6 shadow-xl">
          <img src="img/chefRossi.png"
            class="w-28 h-28 mx-auto rounded-full shadow-xl ring-4 ring-white mb-4 animate-popIn">

          <h2 class="text-2xl font-bold text-jungleRed mb-2">Ingredient #3</h2>

          ${narrationBox(`
            ‚ÄúFantastico! Now travel to the **dairy aisle** and **seasonings section**.  
            You‚Äôll need **mozzarella**, **parmesan**, and **garlic salt**.  
            Imagine you‚Äôre scanning each one in your camera window, then tap Scan when you‚Äôre ready.‚Äù
          `)}

          ${cameraFrame("img/mozzarella.png", "Cheese and seasonings")}

          <div class="flex justify-center gap-3 mt-4 text-xs text-gray-600">
            <span>üßÄ Mozzarella</span>
            <span>üßÄ Parmesan</span>
            <span>üßÇ Garlic Salt</span>
          </div>

          <button id="scanBtn"
            class="w-full bg-jungleGreen text-white font-semibold rounded-lg py-3 mt-6 shadow active:scale-95">
            Scan Ingredient Group
          </button>
        </div>
      `;

      document.getElementById("scanBtn").onclick = () => handleScan(4);
      playAudio("audio3");
    }

    function renderStep4() {
      stepNum.textContent = "4";
      wrapper.innerHTML = `
        <div class="animate-shimmer bg-white/90 rounded-3xl p-6 shadow-xl">
          <img src="img/chefRossi.png"
            class="w-28 h-28 mx-auto rounded-full shadow-xl ring-4 ring-white mb-4 animate-popIn">

          <h2 class="text-2xl font-bold text-jungleRed mb-2">Final Ingredient</h2>

          ${narrationBox(`
            ‚ÄúFor your final stop, glide into the **produce department**.  
            Search for a fresh bundle of **bright green spinach**.  
            Picture it in your camera frame, then tap Scan to finish the adventure!‚Äù
          `)}

          ${cameraFrame("img/spinach.png", "Fresh spinach")}

          <button id="scanBtn"
            class="w-full bg-jungleGreen text-white font-semibold rounded-lg py-3 mt-6 shadow active:scale-95">
            Scan Final Ingredient
          </button>
        </div>
      `;

      document.getElementById("scanBtn").onclick = () => handleScan("done");
      playAudio("audio4");
    }

    /* ---------------------
       SCAN HANDLER
    --------------------- */
    function handleScan(nextStep) {
      const bing = document.getElementById("bing");
      bing.play().catch(()=>{});

      const card = wrapper.querySelector("div");
      card.classList.add("animate-successPop");

      setTimeout(() => {
        if (nextStep === "done") {
          window.location.href = "summary.html";
        } else {
          step = nextStep;
          loadStep();
        }
      }, 650);
    }

    /* ---------------------
       STEP LOADER
    --------------------- */
    function loadStep() {
      if (step === 1) renderStep1();
      if (step === 2) renderStep2();
      if (step === 3) renderStep3();
      if (step === 4) renderStep4();
    }

    // Start hunt
    loadStep();
  </script>

</body>
</html>
