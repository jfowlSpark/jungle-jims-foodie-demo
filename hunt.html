<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Your Ingredient Hunt</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            fancy: ['Quicksand', 'sans-serif']
          },
          colors: {
            jungleGreen: '#1B8A5A',
            jungleGold: '#F3C969',
            jungleRed: '#E94F37',
            jungleCream: '#FAF4E6',
          },
          animation: {
            fadeIn: "fadeIn 0.45s ease-out",
            slideIn: "slideIn 0.4s ease-out",
            popIn: "popIn 0.45s ease-out",
            shimmer: "shimmer 0.5s ease-in-out",
            successPop: "successPop 0.5s ease-out"
          }
        }
      }
    }
  </script>

  <link rel="stylesheet" href="styles.css" />

  <style>
    body { font-family: 'Quicksand', sans-serif; }
  </style>
</head>

<body class="min-h-screen relative bg-gradient-to-br from-jungleGreen via-jungleCream to-jungleGold">

  <!-- Vines -->
  <img src="img/vines_top_left.png" class="absolute top-0 left-0 w-32 opacity-60 pointer-events-none">
  <img src="img/vines_top_right.png" class="absolute top-0 right-0 w-32 opacity-60 pointer-events-none">

  <!-- Replay Audio -->
  <button id="replayBtn"
    class="hidden fixed bottom-6 right-6 w-14 h-14 bg-white/90 border-2 border-jungleGreen rounded-full shadow-xl 
           flex items-center justify-center text-jungleGreen text-2xl active:scale-90 transition z-50">
    üîä
  </button>

  <!-- Step indicator (8 clues total here) -->
  <div id="stepIndicator" class="fixed top-4 left-1/2 -translate-x-1/2 text-white font-bold text-lg drop-shadow z-10">
    Clue <span id="stepNum">1</span> of 8
  </div>

  <!-- MAIN CONTENT WRAPPER -->
  <div id="huntWrapper" class="w-full max-w-md mx-auto text-center pt-16 pb-10 px-4"></div>

  <!-- AUDIO (steps 5‚Äì12 in your master list) -->
  <audio id="audio1" src="audio/chef4_pasta.mp3"></audio>
  <audio id="audio2" src="audio/chef5_fresh_spinach.mp3"></audio>
  <audio id="audio3" src="audio/chef6_frozen_spinach.mp3"></audio>
  <audio id="audio4" src="audio/chef7_mozzarella.mp3"></audio>
  <audio id="audio5" src="audio/chef8_sauce.mp3"></audio>
  <audio id="audio6" src="audio/chef9_sour_cream.mp3"></audio>
  <audio id="audio7" src="audio/chef10_garlic_salt.mp3"></audio>
  <audio id="audio8" src="audio/chef11_eggs.mp3"></audio>
  <audio id="bing"   src="audio/bing.mp3"></audio>

  <script>
    let step = 1;
    let currentAudio = null;

    const wrapper   = document.getElementById("huntWrapper");
    const replayBtn = document.getElementById("replayBtn");
    const stepNum   = document.getElementById("stepNum");

    /* ---------------------
       PLAY AUDIO
    --------------------- */
    function playAudio(id) {
      const nextAudio = document.getElementById(id);
      if (!nextAudio) return;

      if (currentAudio && !currentAudio.paused) {
        currentAudio.pause();
        currentAudio.currentTime = 0;
      }

      currentAudio = nextAudio;
      replayBtn.classList.remove("hidden");

      currentAudio.currentTime = 0;
      currentAudio.play().catch(() => {});
    }

    replayBtn.addEventListener("click", () => {
      if (currentAudio) {
        currentAudio.currentTime = 0;
        currentAudio.play().catch(() => {});
      }
    });

    /* ---------------------
       NARRATION BOX
    --------------------- */
    function narrationBox(text) {
      return `
        <div class="relative bg-white/80 rounded-xl p-4 mt-4 shadow-md text-left animate-slideIn">
          <div class="absolute -top-3 left-6 w-0 h-0 
                      border-l-8 border-r-8 border-b-8 border-transparent 
                      border-b-white/80"></div>
          <p class="text-gray-700 text-lg leading-relaxed">${text}</p>
        </div>
      `;
    }

    /* ---------------------
       CAMERA FRAME
    --------------------- */
    function cameraFrame(imgSrc, altText) {
      return `
        <div class="mt-5 bg-black/80 rounded-3xl p-3 shadow-inner text-left text-xs text-white/60">
          <div class="flex justify-between px-1">
            <span>SCAN MODE</span>
            <span>Live</span>
          </div>
          <div class="mt-2 bg-black rounded-2xl overflow-hidden aspect-[4/3] flex items-center justify-center relative">
            <div class="absolute inset-3 border-2 border-white/40 rounded-2xl pointer-events-none"></div>
            <img src="${imgSrc}" alt="${altText}"
                 class="w-full h-full object-contain" />
          </div>
          <div class="flex justify-center mt-3">
            <div class="w-10 h-10 rounded-full border-2 border-white/70"></div>
          </div>
        </div>
      `;
    }

    /* ---------------------
       CLUE SCREENS (1‚Äì8)
    --------------------- */

    // 1) Pasta ‚Äì now requires a tap to play audio
    function renderStep1() {
      stepNum.textContent = "1";
      wrapper.innerHTML = `
        <div class="animate-shimmer bg-white/90 rounded-3xl p-6 shadow-xl">
          <img src="img/chefRossi.png"
            class="w-28 h-28 mx-auto rounded-full shadow-xl ring-4 ring-white mb-4 animate-popIn">

          <h2 class="text-2xl font-bold text-jungleRed mb-2">Clue #1 ‚Äì Pasta</h2>

          ${narrationBox(`
            ‚ÄúYour journey begins in the **International Pasta Aisle**!  
            Hunt for a bag of **Garofalo pasta** ‚Äî golden penne in a clear bag  
            with elegant black script. Line it up in your camera view, then tap **Scan**.‚Äù
          `)}

          <button id="playPastaClue"
            class="mt-3 w-full bg-white text-jungleGreen border border-jungleGreen font-semibold rounded-lg py-2 shadow active:scale-95">
            üîä Hear Chef Rossi's clue
          </button>

          ${cameraFrame("img/pasta.png", "Garofalo pasta")}

          <button id="scanBtn"
            class="w-full bg-jungleGreen text-white font-semibold rounded-lg py-3 mt-6 shadow active:scale-95">
            Scan Pasta
          </button>
        </div>
      `;

      document.getElementById("playPastaClue").onclick = () => playAudio("audio1");
      document.getElementById("scanBtn").onclick = () => handleScan(2);
      // no auto-play here to avoid autoplay blocking
    }

    // 2) Fresh Spinach (produce)
    function renderStep2() {
      stepNum.textContent = "2";
      wrapper.innerHTML = `
        <div class="animate-shimmer bg-white/90 rounded-3xl p-6 shadow-xl">
          <img src="img/chefRossi.png"
            class="w-28 h-28 mx-auto rounded-full shadow-xl ring-4 ring-white mb-4 animate-popIn">

          <h2 class="text-2xl font-bold text-jungleRed mb-2">Clue #2 ‚Äì Fresh Spinach</h2>

          ${narrationBox(`
            ‚ÄúMolto bene! Now wander to the **produce department**.  
            Look for a bright green bundle of **fresh spinach** ‚Äî crisp leaves, rubber-banded together.  
            Imagine lining it up in your camera window, then tap **Scan**.‚Äù
          `)}

          ${cameraFrame("img/fresh_spinach.png", "Fresh spinach")}

          <button id="scanBtn"
            class="w-full bg-jungleGreen text-white font-semibold rounded-lg py-3 mt-6 shadow active:scale-95">
            Scan Fresh Spinach
          </button>
        </div>
      `;

      document.getElementById("scanBtn").onclick = () => handleScan(3);
      playAudio("audio2");
    }

    // 3) Frozen Spinach
    function renderStep3() {
      stepNum.textContent = "3";
      wrapper.innerHTML = `
        <div class="animate-shimmer bg-white/90 rounded-3xl p-6 shadow-xl">
          <img src="img/chefRossi.png"
            class="w-28 h-28 mx-auto rounded-full shadow-xl ring-4 ring-white mb-4 animate-popIn">

          <h2 class="text-2xl font-bold text-jungleRed mb-2">Clue #3 ‚Äì Frozen Spinach</h2>

          ${narrationBox(`
            ‚ÄúFantastico! From fresh to frozen ‚Äî glide to the **frozen vegetable aisle**.  
            Search for a bag of **frozen spinach** to keep your bake hearty and convenient.  
            Picture it in your camera frame, then tap **Scan**.‚Äù
          `)}

          ${cameraFrame("img/frozen_spinach.png", "Frozen spinach")}

          <button id="scanBtn"
            class="w-full bg-jungleGreen text-white font-semibold rounded-lg py-3 mt-6 shadow active:scale-95">
            Scan Frozen Spinach
          </button>
        </div>
      `;

      document.getElementById("scanBtn").onclick = () => handleScan(4);
      playAudio("audio3");
    }

    // 4) Mozzarella
    function renderStep4() {
      stepNum.textContent = "4";
      wrapper.innerHTML = `
        <div class="animate-shimmer bg-white/90 rounded-3xl p-6 shadow-xl">
          <img src="img/chefRossi.png"
            class="w-28 h-28 mx-auto rounded-full shadow-xl ring-4 ring-white mb-4 animate-popIn">

          <h2 class="text-2xl font-bold text-jungleRed mb-2">Clue #4 ‚Äì Mozzarella</h2>

          ${narrationBox(`
            ‚ÄúNext stop: the **dairy aisle**.  
            You‚Äôre hunting for a bag of shredded **mozzarella cheese** ‚Äî  
            perfect for a melty, bubbly top. Line that bag up in your camera window, then tap **Scan**.‚Äù
          `)}

          ${cameraFrame("img/mozzarella.png", "Mozzarella cheese")}

          <button id="scanBtn"
            class="w-full bg-jungleGreen text-white font-semibold rounded-lg py-3 mt-6 shadow active:scale-95">
            Scan Mozzarella
          </button>
        </div>
      `;

      document.getElementById("scanBtn").onclick = () => handleScan(5);
      playAudio("audio4");
    }

    // 5) Pasta Sauce
    function renderStep5() {
      stepNum.textContent = "5";
      wrapper.innerHTML = `
        <div class="animate-shimmer bg-white/90 rounded-3xl p-6 shadow-xl">
          <img src="img/chefRossi.png"
            class="w-28 h-28 mx-auto rounded-full shadow-xl ring-4 ring-white mb-4 animate-popIn">

          <h2 class="text-2xl font-bold text-jungleRed mb-2">Clue #5 ‚Äì Pasta Sauce</h2>

          ${narrationBox(`
            ‚ÄúBellissimo! Now head to the **pasta sauce aisle**.  
            Look for a jar or two-pack of **tomato & basil pasta sauce** ‚Äî deep red, classic Italian label.  
            Imagine your camera locking onto that rich red color, then tap **Scan**.‚Äù
          `)}

          ${cameraFrame("img/pasta_sauce.png", "Tomato & basil pasta sauce")}

          <button id="scanBtn"
            class="w-full bg-jungleGreen text-white font-semibold rounded-lg py-3 mt-6 shadow active:scale-95">
            Scan Pasta Sauce
          </button>
        </div>
      `;

      document.getElementById("scanBtn").onclick = () => handleScan(6);
      playAudio("audio5");
    }

    // 6) Sour Cream
    function renderStep6() {
      stepNum.textContent = "6";
      wrapper.innerHTML = `
        <div class="animate-shimmer bg-white/90 rounded-3xl p-6 shadow-xl">
          <img src="img/chefRossi.png"
            class="w-28 h-28 mx-auto rounded-full shadow-xl ring-4 ring-white mb-4 animate-popIn">

          <h2 class="text-2xl font-bold text-jungleRed mb-2">Clue #6 ‚Äì Sour Cream</h2>

          ${narrationBox(`
            ‚ÄúTo make your bake extra creamy, stay in the **dairy section**  
            and find a tub of **sour cream** ‚Äî bright white container, bold lettering.  
            Line it up in your camera view, then tap **Scan**.‚Äù
          `)}

          ${cameraFrame("img/sour_cream.png", "Sour cream")}

          <button id="scanBtn"
            class="w-full bg-jungleGreen text-white font-semibold rounded-lg py-3 mt-6 shadow active:scale-95">
            Scan Sour Cream
          </button>
        </div>
      `;

      document.getElementById("scanBtn").onclick = () => handleScan(7);
      playAudio("audio6");
    }

    // 7) Garlic Salt
    function renderStep7() {
      stepNum.textContent = "7";
      wrapper.innerHTML = `
        <div class="animate-shimmer bg-white/90 rounded-3xl p-6 shadow-xl">
          <img src="img/chefRossi.png"
            class="w-28 h-28 mx-auto rounded-full shadow-xl ring-4 ring-white mb-4 animate-popIn">

          <h2 class="text-2xl font-bold text-jungleRed mb-2">Clue #7 ‚Äì Garlic Salt</h2>

          ${narrationBox(`
            ‚ÄúNow spice things up! Stroll to the **seasonings aisle**  
            and search for a shaker of **garlic salt** ‚Äî  
            white label with golden garlic bulbs. When you spy it, imagine your scanner beeping,  
            then tap **Scan**.‚Äù
          `)}

          ${cameraFrame("img/garlic_salt.png", "Garlic salt")}

          <button id="scanBtn"
            class="w-full bg-jungleGreen text-white font-semibold rounded-lg py-3 mt-6 shadow active:scale-95">
            Scan Garlic Salt
          </button>
        </div>
      `;

      document.getElementById("scanBtn").onclick = () => handleScan(8);
      playAudio("audio7");
    }

    // 8) Eggs
    function renderStep8() {
      stepNum.textContent = "8";
      wrapper.innerHTML = `
        <div class="animate-shimmer bg-white/90 rounded-3xl p-6 shadow-xl">
          <img src="img/chefRossi.png"
            class="w-28 h-28 mx-auto rounded-full shadow-xl ring-4 ring-white mb-4 animate-popIn">

          <h2 class="text-2xl font-bold text-jungleRed mb-2">Clue #8 ‚Äì Eggs</h2>

          ${narrationBox(`
            ‚ÄúFor the final touch, return to the **egg case**.  
            Find a carton of **large eggs** to bind all these delicious ingredients together.  
            Picture the carton in your camera frame‚Ä¶ then tap **Scan** to finish your hunt!‚Äù
          `)}

          ${cameraFrame("img/eggs.png", "Eggs")}

          <button id="scanBtn"
            class="w-full bg-jungleGreen text-white font-semibold rounded-lg py-3 mt-6 shadow active:scale-95">
            Scan Eggs & Finish
          </button>
        </div>
      `;

      document.getElementById("scanBtn").onclick = () => handleScan("done");
      playAudio("audio8");
    }

    /* ---------------------
       SCAN HANDLER
    --------------------- */
    function handleScan(nextStep) {
      const bing = document.getElementById("bing");
      if (bing) {
        bing.currentTime = 0;
        bing.play().catch(() => {});
      }

      const card = wrapper.querySelector("div");
      if (card) card.classList.add("animate-successPop");

      setTimeout(() => {
        if (nextStep === "done") {
          window.location.href = "summary.html";
        } else {
          step = nextStep;
          loadStep();
        }
      }, 650);
    }

    /* ---------------------
       STEP LOADER
    --------------------- */
    function loadStep() {
      switch (step) {
        case 1: renderStep1(); break;
        case 2: renderStep2(); break;
        case 3: renderStep3(); break;
        case 4: renderStep4(); break;
        case 5: renderStep5(); break;
        case 6: renderStep6(); break;
        case 7: renderStep7(); break;
        case 8: renderStep8(); break;
      }
    }

    // Start hunt
    loadStep();
  </script>

</body>
</html>
